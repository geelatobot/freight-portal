# 货代客户门户 - 需求规格说明书 V3.0

## 1. 项目概述

### 1.1 项目背景
为货代公司客户提供一个统一的在线服务平台，替代传统的电话/邮件查询方式，提升客户服务效率和体验。同时提供内部管理后台，供业务人员、客服人员、财务人员使用。

### 1.2 产品矩阵

| 产品 | 用户 | 主要功能 | 技术形式 |
|------|------|---------|---------|
| **客户Web端** | 货代客户 | 货物查询、下单、财务查询 | Web应用(PC/移动端适配) |
| **客户小程序** | 货代客户 | 货物查询、订单跟踪、消息通知 | 微信小程序 |
| **管理后台** | 内部员工 | 客户管理、订单管理、数据管理 | Web应用 |

### 1.3 集成范围
- 内部ERP系统（客户自有）
- 四港物流宝API（4portun）- 第三方物流数据
- 微信支付/支付宝 - 在线支付

---

## 2. 用户角色

### 2.1 客户侧角色

| 角色 | 权限 | 描述 |
|------|------|------|
| 企业管理员 | 全权限 | 管理企业下所有子账号、查看所有数据、审批订单 |
| 业务操作员 | 业务权限 | 下单、查询货物、管理委托、查看账单 |
| 财务人员 | 财务权限 | 查看账单、发票、进行对账、在线支付 |
| 只读用户 | 查看权限 | 仅查看货物状态，不可操作 |

### 2.2 平台侧角色

| 角色 | 职责 | 权限 |
|------|------|------|
| 系统管理员 | 平台配置、账号管理、权限分配 | 全部权限 |
| 客服人员 | 处理客户咨询、异常处理、订单跟进 | 客户管理、订单管理、消息发送 |
| 运营人员 | 数据查看、报表导出、业务分析 | 数据查看、报表导出 |
| 销售代表 | 客户跟进、报价管理、客户开发 | 客户管理、报价管理 |
| 财务人员 | 账单审核、发票管理、对账处理 | 财务管理、账单审核 |

---

## 3. 功能需求

### 3.1 客户Web端功能

#### 3.1.1 用户认证与账户管理
- [ ] 企业客户注册（需平台审核）
- [ ] 登录（账号密码/短信验证码/微信扫码）
- [ ] 忘记密码/重置密码
- [ ] 子账号管理（企业管理员可添加/禁用子账号）
- [ ] 个人信息维护
- [ ] 企业信息维护
- [ ] 登录日志查看

#### 3.1.2 货物追踪中心（核心功能）
- [ ] **快速查询**：输入箱号/提单号/订单号查询
- [ ] **货物列表**：显示该客户所有在途/历史货物
- [ ] **货物详情页**：
  - 货物基本信息（箱号、提单号、船名航次、起运港/目的港）
  - 状态时间轴（图形化展示节点进度）
  - 节点详情（时间、地点、状态说明）
  - 预计时间（ETD/ETA）
- [ ] **筛选与搜索**：按时间、状态、航线筛选
- [ ] **订阅管理**：订阅/取消订阅货物状态变更通知
- [ ] **异常标记**：显示延误、滞留等异常状态
- [ ] **导出功能**：导出货物清单（Excel）

#### 3.1.3 订单管理
- [ ] **在线下单**：
  - 海运整箱(FCL)下单
  - 海运拼箱(LCL)下单
  - 空运下单
  - 陆运下单
- [ ] **智能报价**：输入起运港、目的港、货量，获取预估费用
- [ ] **订单列表**：查看所有订单及状态
- [ ] **订单详情**：查看订单完整信息、处理进度
- [ ] **订单状态**：待确认→已确认→执行中→已完成→已取消
- [ ] **订单变更**：申请修改订单信息
- [ ] **订单取消**：申请取消订单（需审批）
- [ ] **常用地址**：保存常用收发货地址
- [ ] **委托单模板**：保存常用委托信息，快速下单

#### 3.1.4 财务中心
- [ ] **账单列表**：查看所有账单
- [ ] **账单详情**：费用明细、计费方式、汇率
- [ ] **发票管理**：
  - 发票列表与下载
  - 申请开票
  - 发票邮寄地址管理
- [ ] **在线支付**：
  - 微信支付
  - 支付宝
  - 对公转账（上传凭证）
- [ ] **对账单**：月度对账单查看与确认
- [ ] **费用预估**：输入货物信息，预估总费用
- [ ] **付款记录**：历史付款记录查询
- [ ] **信用额度**：查看可用信用额度

#### 3.1.5 消息通知
- [ ] 站内消息列表
- [ ] 消息分类（货物状态、订单状态、账单、系统公告）
- [ ] 消息详情查看
- [ ] 消息已读/未读标记
- [ ] 通知设置（开关各类通知）

#### 3.1.6 个人中心
- [ ] 账号信息
- [ ] 修改密码
- [ ] 绑定手机/邮箱
- [ ] 绑定微信（接收通知）
- [ ] 企业认证信息
- [ ] 常用联系人管理

---

### 3.2 客户小程序功能

#### 3.2.1 核心功能（与Web端一致）
- [ ] 货物快速查询（扫码/输入）
- [ ] 货物列表与详情
- [ ] 订单列表与详情
- [ ] 订单状态跟踪
- [ ] 账单查看
- [ ] 在线支付
- [ ] 个人中心

#### 3.2.2 小程序特有功能
- [ ] **扫码查询**：扫描集装箱号/提单号二维码
- [ ] **微信模板消息推送**：
  - 货物状态变更通知
  - 订单状态变更通知
  - 账单/发票通知
  - 异常预警通知
- [ ] **分享功能**：分享货物跟踪给同事
- [ ] **一键拨号**：联系客服/销售

---

### 3.3 管理后台功能

#### 3.3.1 客户管理
- [ ] 客户列表（企业客户）
- [ ] 客户详情（基本信息、联系人、历史订单）
- [ ] 客户审核（新注册客户审核）
- [ ] 客户分级（VIP/普通客户）
- [ ] 客户分配（分配给销售代表）
- [ ] 客户跟进记录
- [ ] 客户信用额度管理

#### 3.3.2 订单管理
- [ ] 订单列表（全部订单）
- [ ] 订单详情查看
- [ ] 订单审批（新订单审核）
- [ ] 订单状态更新
- [ ] 订单分配（分配给操作员）
- [ ] 订单异常处理
- [ ] 订单导出

#### 3.3.3 货物跟踪管理
- [ ] 货物列表（全部货物）
- [ ] 货物详情（包含4portun同步数据）
- [ ] 手动更新货物状态
- [ ] 异常货物标记与处理
- [ ] 货物数据同步日志

#### 3.3.4 财务管理
- [ ] 账单管理（生成/审核/修改账单）
- [ ] 发票管理（开票/邮寄/作废）
- [ ] 收款确认
- [ ] 对账单管理
- [ ] 财务报表（收入统计、应收款统计）
- [ ] 退款处理

#### 3.3.5 报价管理
- [ ] 运价维护（各航线运价）
- [ ] 附加费维护
- [ ] 客户专属报价
- [ ] 报价有效期管理

#### 3.3.6 系统管理
- [ ] 账号管理（内部员工账号）
- [ ] 角色权限管理
- [ ] 操作日志审计
- [ ] 系统配置（通知模板、审批流程）
- [ ] 数据字典维护

#### 3.3.7 数据看板
- [ ] 今日数据概览（订单数、在途货物、待处理事项）
- [ ] 业务统计（月度订单量、收入趋势）
- [ ] 客户统计（新增客户、活跃客户）
- [ ] 异常预警（延误货物、待处理订单）

---

### 3.4 系统集成模块

#### 3.4.1 内部ERP系统对接
- [ ] **数据同步方向**：
  - ERP → 门户：客户信息、订单信息、财务数据
  - 门户 → ERP：新订单、支付信息、状态更新
- [ ] **同步数据类型**：
  - 客户主数据
  - 订单数据
  - 货物状态
  - 财务数据（账单、发票、收款）
  - 库存数据（可用舱位）
- [ ] **同步方式**：API接口 + 消息队列
- [ ] **同步频率**：实时/定时
- [ ] **数据一致性保障**：事务+补偿机制

#### 3.4.2 四港物流宝(4portun) API对接
- [ ] **箱货跟踪API**
  - 全球70+船司数据
  - 全国10大口岸
  - 节点：放箱、提空、进港、放行、离港、抵港、卸货、提重、还空
- [ ] **关务数据API 4.0**
  - 海关状态查询
  - 预配舱单、海关放行、结关
- [ ] **海运综合API**
  - 多式联运跟踪
- [ ] **数据订阅模式**：Webhook实时推送
- [ ] **数据缓存与更新**：本地缓存+增量更新

#### 3.4.3 支付系统对接
- [ ] 微信支付（JSAPI/Native/H5）
- [ ] 支付宝（PC/手机网站）
- [ ] 对公转账（线下转账+凭证上传）

---

### 3.5 AI能力模块（增值功能）

#### 3.5.1 智能客服
- [ ] 货物状态问答（"我的货到哪里了？"）
- [ ] 运价咨询（"上海到洛杉矶多少钱？"）
- [ ] 船期查询（"下周有去汉堡的船吗？"）
- [ ] 异常处理指引

#### 3.5.2 OCR识别
- [ ] 提单识别（自动提取船名航次、箱号、货描）
- [ ] 发票识别（自动录入费用信息）
- [ ] 装箱单识别

#### 3.5.3 智能预测与推荐
- [ ] 到港时间预测
- [ ] 异常预警智能分析
- [ ] 最优航线推荐

---

## 4. 非功能需求

### 4.1 性能要求
| 指标 | 要求 |
|------|------|
| 页面首屏加载 | < 2秒 |
| API响应时间(P95) | < 500ms |
| 并发用户数 | 1000+ |
| 日查询量 | 10万+ |
| 系统吞吐量 | 1000单/小时 |

### 4.2 安全要求
- 数据加密传输（HTTPS/TLS 1.3）
- 敏感数据加密存储（AES-256）
- API访问限流（Rate Limiting）
- 防SQL注入/XSS/CSRF
- 完整操作审计日志
- 数据备份策略（每日增量、每周全量）
- 灾难恢复方案（RTO<4h, RPO<1h）

### 4.3 可用性要求
- 系统可用性 99.9%
- 计划内维护窗口 < 4小时/月
- 支持蓝绿部署

### 4.4 兼容性要求
- **Web端**：Chrome/Firefox/Safari/Edge 最新2个版本
- **移动端**：iOS 12+, Android 8+
- **小程序**：微信最新版本

### 4.5 国际化要求
- 语言：简体中文（首期）、英文（二期）
- 时区：支持多时区显示
- 币种：USD、CNY、EUR

---

## 5. 待确认事项

- [ ] 客户ERP系统接口文档（数据格式、接口协议）
- [ ] 4portun API接入申请（接口文档、配额、费用）
- [ ] 客户现有数据量评估（历史订单数、在途货物数、客户数）
- [ ] 预算范围
- [ ] 上线时间规划
- [ ] 是否需要多语言支持（英文版）
- [ ] 是否需要APP版本（iOS/Android）

---

## 6. 参考竞品

### Flexport
- SKU级货物追踪
- 碳排放计算器
- 供应链金融服务

### 运去哪
- "现舱特价专区"
- 30分钟预配信息出具
- 自动化风险预警推送

### 四港物流宝(4portun)
- 全球70+船司数据覆盖
- 全国10大口岸+海外30+码头
- 关务数据4.0（海+陆+空）
